---
layout  : wiki
title   : "An introduction to Generalized linear models Chapter 10"
summary : "Chapter 10. Survival analysis"
date    : 2022-02-08 10:59:06 +0900
updated : 2022-02-08 13:08:53 +0900
tag     : 
toc     : true
public  : true
parent  : [[2022-01-10-introduction_GLM]]
latex   : false
---

## 10.1 Introduction

Two importatn features:  
* the times are non-negative and typically have skewed distributions with long tails;
* where the failure times are not known completely, the data are said to be **censored**.

* 이 책에서는 parametric model만 다룬다.  
Inferences are usually more precise and there is a wider range of models with which to describe the data, including **accelerated faiulre time models**.  

* 또한, 이 책에서는 time-dependent explanatory variables, discrete survival time models를 다루지 않는다.

The likelihood function contains two components,  
one involving the uncensored survival times and  
the other making as much use as possible of information about the survival times which are censored.

## 10.2 Survivor functions and hazard functions

The probability of failure before a specific time $y$ is given by the cumulative probability distribution: $F(y)$  
The *survivor function** is the probability of survival beyond time $y$.

* Equation 10.1
$$S(y)=Pr(Y\geq y) = 1-F(y)$$

The **hazard function** is the probability of death in an infinitesimally small time between $y$ and $(y+\delta y)$, given survival up to time $y$,  

* Equation 10.2
$$h(y)=\frac{f(y)}{S(y)}$$
which can also be written as  

* Equation 10.3
$$h(y)=-\frac{d}{dy}\left\{\log[S(y)]\right\}$$

Hence,  

* Equation 10.4
$$H(y)=-\log[S(y)]$$

$H(y)$ is called the **cumulative hazard function**.

### 10.2.1 Exponential distribution

* Equation 10.5
$$f(y;\theta)=\theta e^{-\theta y},\,y\geq 0, \theta>0.$$

$E(Y)=1/\theta$ and $var(Y)=1/\theta^2$

So the survivor function is  

* Equation 10.6
$$S(y;\theta)=e^{-\theta y},$$

The hazard function does not depend on $y$, this "lack of memory" property may be a limitation.  
The probability of failure often increases with time. Such as the Weibull distribution, may be more appropriate.

### 10.2.2 Proportional hazards model

hazard ratio or relative hazard  

* Equation 10.7
$$\frac{h_1(y;\beta)}{h_0(y;\beta)}=e^{\beta k}$$

proportional hazards models and $h_0(y)$, which is the hazard function corresponding to the reference levels for all the explanatory variables, is called the **baseline hazard**.  

* Equation 10.8
$$h_1(y)=h_0(y)e^{\mathbf{x}^T\beta}$$

* Equation 10.9
$$\log H_P(y)=\log H_A(y) +\beta_k$$

so the log cumulative hazard function differ by a constant.

### 10.2.3 Weibull distribution

The parameter $\lambda$ and $\theta$ determine the shape of the distribution and the scale, respectively.  
It is convenient to reparametrize the distribution using $\theta^{-\lambda}=\phi$.  

The probability density function  
* Equation 10.10
$$f(y;\lambda, \phi)=\lambda\phi y^{\lambda-1}\exp(-\phi y^\lambda)$$

The exponential distribution is a special case of the Weibull distribution with $\lambda=1$.  
The survivor function is  

* Equation 10.11
$$S(y;\lambda, \phi)=\exp(-\phi y^\lambda)$$

The hazard function is  

* Equation 10.12
$$h(y;\lambda,\phi)=\lambda\phi y^{\lambda-1}$$

The hazard function depends on $y$, and with suitable values of $\lambda$ it can increase or decrease with increasing survival time. - Thus, the Weibull distribution yields **accelerated failure time** models.  

* Equation 10.13
$$\log H(y)=\log[-\log S(y)]$$

Then the hazard function (10.12) becomes  

* Equation 10.14
$$h(y;\lambda, \phi)=\lambda\alpha y^{\lambda-1}e^{\mathbf{X}^T\beta}$$
