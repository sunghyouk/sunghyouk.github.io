---
layout  : wiki
title   : "쏙쏙 들어오는 인공지능 알고리즘 Chapter 6"
summary : "Chapter 6. 군집 지능: 개미"
date    : 2022-02-10 23:22:26 +0900
updated : 2022-02-12 22:13:25 +0900
tag     : 
toc     : true
public  : true
parent  : [[2022-01-07-Grokking_AI_algorithm]]
latex   : false
---

## 군집 지능이란?

특정 문제 공간에서 여러 제약 조건을 충족해야 하고 가능한 솔루션이 많기 때문에 가장 좋은 솔루션을 찾기 어려운 최적화 문제를 해결하는 데 유용  

## 개미 군집 최적화를 적용할 수 있는 문제

관광 명소가 서버이고 경로가 네트워크 연결이라고 가정  
무차별 대입 방법이 한 방법이지만 대규모 데이터 세트에 대해서 계산 비용이 많이 들고 시간이 오래 걸린다.

## 상태 표현: 경로와 개미는 어떤 모습일까?

거리 행렬 distance matrix은 모든 인덱스가 개체를 나타내는 2차원 배열이다.  
거리 행렬의 행과 열에 해당하는 인덱스가 나타내는 위치에 있는 값은 각 인덱스가 나타내는 개체 간 거리이다. (NOTE: Chapter 2. 인접 행렬)  
거리 행렬은 배열의 x, y에 대한 참조가 명소 x와 명소 y 사이의 거리를 참조하는 배열의 배열이다.  

개미는 다른 명소로 이동하고 이때 길에 페로몬을 남긴다.  
개미는 다음에 어느 명소를 방문할지 판단하고, 각자 총 이동 거리가 얼마인지 알고 있다.  
개미의 기본 속성:  
* 기억력: 이미 방문한 명소의 목록
* 최적 적합도: 모든 명소를 방문하기 위해 이동한 총 거리 중 최단 거리
* 행동: 다음 방문할 목적지를 선택

마지막으로 설계해야 하는 데이터 구조는 페로몬 흔적의 개념이다.  
페로몬 강도는 거리 행렬로 표현할 수 있다.

## 개미 군집 최적화 알고리즘 수명 주기

개미 군집 최적화 알고리즘을 구성하는 방법:  
* 페로몬 흔적 초기화
* 개미 모집단 설정 - 각각 서로 다른 명소에서 시작하는 개미 모집단
* 각 개미의 다음 방문지 선택
* 페로몬 흔적 업데이트
* 최적 솔루션 업데이트
* 중지 기준 결정 - 실행할 총 반복 횟수를 결정

### 페로몬 흔적 초기화

아직 명소 사이의 길을 통과하는 개미가 없었기 때문에 페로몬 흔적은 1로 초기화한다.

### 개미 모집단 설정

개미는 무작위로 할당한 명소에서 출발 - 임의의 시작 명소를 선택  
*Example* 태스크 스케줄링 문제 - 각 개미가 서로 다른 태스크에서 시작한다고 생각

### 각 개미의 다음 방문지 선택

개미는 모든 명소를 한 번씩 방문할 때까지 새로운 명소를 방문: 여행  
* 페로몬 강도
* 휴리스틱 값 - 명소 간 경로의 거리
이를 기반으로 다음 방문할 목적지를 결정

#### 개미의 확률적 속성

무작위성 요소: 0과 1사이의 임의의 숫자를 생성하고 결과가 0.1 이하면 개미는 무작위로 목적지를 선택

#### 휴리스틱에 의한 목적지 선택

해당 경로의 페로몬 강도와 휴리스틱 값을 결정:  
$$\frac{p_x^\alpha \times (1/{h_x})^\beta}{\sum^n(p_n^\alpha \times (1/{h_n})^\beta)}$$

이 함수를 각각의 목적지를 향해 이동 가능한 모든 경로에 적용  
$\alpha$와 $\beta$ 변수는 페로몬 영향과 휴리스틱 영향 중 어느 한 쪽에 더 큰 가중치를 주기 위해 사용  

1) 방문할 수 있는 명소 결정
2) 명소의 인덱스 저장,  
   각각의 인덱스에 대한 확률을 저장,  
   모든 확률의 합을 저장, 함수를 종료하면 그 값은 1이어야 함
3) 룰렛 휠 선택 함수

### 페로몬 흔적 업데이트

남겨진 페로몬 강도를 바타응로 명소 간 페로몬 흔적을 변경 - 모든 개미가 각각 둘러보기를 마친 후, 페로몬 흔적을 지우고 개미의 이동에 따라 페로몬 흔적을 업데이트  

### 증발로 인한 페로몬 흔적 업데이트

시간이 지남에 따라 페로몬 흔적의 강도가 감소 - 증발 계수를 곱하여 업데이트

### 개미의 여행에 따른 페로몬 흔적 업데이트

각 개미는 자신이 이동한 모든 경로의 페로몬에 자신의 적합도 값을 더한다. - 해당 경로에서의 개미 이동에 따라 페로몬을 추가  

### 최적 솔루션 업데이트

가장 좋은 솔루션은 명소 방문 시퀀스 중에 총 거리가 가장 짧은 것 - 최고의 개미 중에서 최적 솔루션 선택하기  
총 이동 거리가 가장 짧은 개미를 찾아 군집에서 새로운 최고의 개미로 설정

### 중지 기준 결정

반복은 개념적으로 개미 그룹이 결론을 내리기까지의 여행 회수  
* 미리 정의한 반복 횟수에 도달하면 중지
* 최적 솔루션이 정체되면 중지

하이퍼 파라미터의 설정:  
* 일부 무작위성 - 임의의 명소를 선택해서 개미가 방문할 확률 설정
* 페로몬 가중치 ($\alpha$)
* 휴리스틱 가중치 ($\beta$)
* 개미의 수
* 개미가 가진 총 반복 횟수
* 페로몬 증발 비율 설정

## 개미 군집 최적화 알고리즘 사용 사례

* 경로 최적화 (라우팅 문제)
* 작업 스케쥴링 - 개미가 다른 순서로 작업을 방문하는 것으로 보면 된다.
* 이미지 처리 - 윤곽선 검출에 사용할 수 있다.
 
